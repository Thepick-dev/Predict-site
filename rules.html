<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>GOALSTORM! — WORLD CUP 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
:root{
  --panel:#0b0b1f;
  --neon:#00f6ff;
  --dim:#666;
  --cyan:#00F6FF;
  --yellow:#FFD60A;
  --pink:#FF2FC7;
  --purple:#D94CFF;
  --white:#F7F7F2;
  --ok:#22ff88;
  --warn:#ffcc00;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{
  background:radial-gradient(circle at top,#0c0c2a,#000);
  color:#e8faff;
  font-family:"Press Start 2P",monospace;
  display:flex;
  flex-direction:column;
  align-items:center;
}
/* NAV */
.nav{
  width:100%;max-width:960px;
  display:flex;justify-content:space-around;
  margin:16px auto 10px;padding:0 10px;gap:6px;
}
.nav a{
  flex:1;font-size:10px;padding:12px 4px;color:#9aa;
  text-decoration:none;border:1px solid rgba(0,246,255,.25);
  box-shadow:0 0 6px rgba(0,246,255,.25);display:flex;
  align-items:center;justify-content:center;
}
.nav a.active{
  color:var(--purple);border:2px solid var(--purple);
  box-shadow:0 0 25px var(--purple);animation:pulse 1.1s infinite;
}
@keyframes pulse{
  0%,100%{box-shadow:0 0 10px var(--purple);}
  50%{box-shadow:0 0 35px var(--purple);}
}
/* BANNER */
.banner-slot{width:100%;max-width:960px;margin-bottom:20px;}
.banner-slot img{width:100%;display:block;}

/* PANELS */
.panel{
  width:100%;max-width:960px;
  background:var(--panel);
  border:2px solid var(--neon);
  box-shadow:0 0 25px rgba(0,246,255,.35);
  padding:20px;margin-bottom:20px;
}
h1{font-size:18px;margin-bottom:16px;color:var(--neon);}
.instructions{font-size:12px;line-height:1.6;color:var(--yellow);margin-bottom:20px;}

/* INPUTS */
input, select{
  width:100%;padding:10px;margin:8px 0;
  background:#000;color:#e8faff;
  border:2px solid var(--neon);
  font-family:inherit;font-size:10px;
}
input::placeholder{color:var(--neon);}

/* BUTTONS */
button{
  font-family:inherit;font-size:10px;padding:6px 0;
  width:32px;background:#000;color:var(--neon);
  border:2px solid var(--neon);cursor:pointer;
}
button:disabled{opacity:.35;cursor:not-allowed;}
button[data-o="N"].selected{background:var(--cyan);color:#000;box-shadow:0 0 12px var(--cyan);}
button[data-o="ET"].selected{background:var(--yellow);color:#000;box-shadow:0 0 12px var(--yellow);}
button[data-o="P"].selected{background:var(--pink);color:#000;box-shadow:0 0 12px var(--pink);}

/* GRID */
.bracket-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;}
@media(max-width:700px){.bracket-grid{grid-template-columns:1fr;}}
.match{border:1px solid var(--dim);padding:8px;}
.team-row{display:flex;gap:6px;margin-bottom:4px;align-items:center;}
.team-name{flex:1;text-align:left;font-size:10px;color:var(--neon);}
.stage-title{color:var(--yellow);font-size:12px;margin:20px 0 8px;}

/* LOCK BUTTON */
#lockBtn{
  display:block;margin:24px auto 0;width:auto;
  padding:14px 22px;font-size:11px;letter-spacing:1px;
  border-color:var(--purple);
}
#lockBtn:not(:disabled){
  color:var(--purple);box-shadow:0 0 18px var(--purple);
  animation:pulse 1.2s infinite;
}

/* POPUP / PSBP OVERLAY */
#psbpOverlay {
  display:none; position:fixed; inset:0; 
  background:rgba(0,0,0,0.9); z-index:1000;
  overflow-y:auto; padding:20px;
  align-items:center; justify-content:center;
}
.psbp-content {
  width:100%; max-width:520px; background:var(--panel);
  border:3px solid var(--pink); padding:20px; text-align:center;
}
.card-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:4px;margin:15px 0;}
.card{
  position:relative;height:50px;border:2px solid var(--cyan);
  background:url('banner1.jpg') center/cover no-repeat;
  color:var(--cyan);display:flex;
  align-items:center;justify-content:center;font-size:11px;cursor:pointer;
}
.card.revealed{
  border-color:var(--ok);
  background:url('card_reveal.jpg') center/cover no-repeat;
  cursor:default;
}
.card-number{display:none; font-size:10px; font-weight:bold; background: rgba(0,0,0,0.5); padding: 2px;}
.card.revealed .card-number{display:block;}
.multiplier-box{
  margin:10px auto;width:100px;padding:10px;font-size:18px;
  border:3px solid var(--pink);color:var(--pink);
}

/* SUMMARY FINAL */
#finalSummary {
  display:none; position:fixed; inset:0; 
  background:var(--panel); z-index:1100;
  overflow-y:auto; padding:20px;
}
.summary-box {
  max-width:600px; margin:0 auto; border:2px solid var(--yellow); padding:20px;
}
.summary-item { margin-bottom:12px; font-size:10px; border-bottom:1px solid #333; padding-bottom:5px;}
.summary-item strong { color:var(--yellow); }
.final-btns { display:flex; gap:10px; margin-top:20px; }
.final-btns button { flex:1; width:auto; padding:15px; }
</style>
</head>
<body>

<div class="nav">
  <a href="#">HOME</a>
  <a href="#" class="active">PLAY</a>
  <a href="#">SCORES</a>
  <a href="#">RULES</a>
</div>

<div class="banner-slot">
  <img src="banner1.jpg" alt="GOALSTORM BANNER">
</div>

<div id="mainContent">
    <div class="panel">
        <h1>PLAYER ENTRY TERMINAL</h1>
        <input id="user" placeholder="USERNAME" oninput="refresh()">
        <input id="email" placeholder="EMAIL" oninput="refresh()">
        <input id="goals" type="number" placeholder="TOTAL GOALS (L32+L16+QF)" oninput="refresh()">
    </div>

    <div class="panel">
        <h1>KNOCKOUT BRACKET</h1>
        <div class="instructions">
            PICK THE TEAM YOU THINK WILL WIN EACH MATCH AND THEIR METHOD OF VICTORY<br>
            (N = AFTER NORMAL TIME, ET = AFTER ET, P = ON PENALTIES)
        </div>
        <div class="stage-title">LAST 32</div>
        <div id="r32" class="bracket-grid"></div>
        <div class="stage-title">LAST 16</div>
        <div id="r16" class="bracket-grid"></div>
        <div class="stage-title">QUARTER FINALS</div>
        <div id="qf" class="bracket-grid"></div>
        <button id="lockBtn" disabled onclick="openPSBP()">LOCK IN &amp; PROCEED TO PLAYER SELECTOR</button>
    </div>
</div>

<div id="psbpOverlay">
    <div class="psbp-content">
        <h1 style="color:var(--pink)">DANGEROUS DUO</h1>
        <select id="duoSelect">
            <option>RICE × HAALAND</option>
            <option>MESSI × NEYMAR</option>
            <option>RONALDO × MBAPPÉ</option>
            <option>LEWANDOWSKI × KANE</option>
            <option>SALAH × STERLING</option>
            <option>KDB × BERNARDO</option>
            <option>DEBRUYNE × FODEN</option>
            <option>HAALAND × MOUNT</option>
            <option>NEYMAR × MBAPPÉ</option>
            <option>RONALDO × SANCHEZ</option>
            <option>SON × KANE</option>
            <option>VARDY × GREALISH</option>
            <option>HAZARD × BENZEMA</option>
            <option>FIRMINO × MANÉ</option>
            <option>DEPAY × DEST</option>
        </select>
        <div class="multiplier-box" id="multiplierBox">1.00</div>
        <div class="instructions" style="font-size:8px">GET AS CLOSE TO 2 WITHOUT GOING OVER. DEAD CARDS (☠) RESET TO 1.00 AND LOCK PICKS.</div>
        <div class="card-grid" id="cardGrid"></div>
        <button id="stickBtn" style="width:100%; border-color:var(--yellow); color:var(--yellow);" onclick="finishGame()">STICK &amp; SUBMIT PICKS</button>
    </div>
</div>

<div id="finalSummary">
    <div class="summary-box">
        <h1 style="color:var(--yellow)">SUBMISSION SUMMARY</h1>
        <div id="summaryResults"></div>
        <div class="final-btns">
            <button onclick="location.reload()">HOME</button>
            <button style="border-color:var(--pink); color:var(--pink)" onclick="location.reload()">RESET (DEV)</button>
        </div>
    </div>
</div>

<script>
'use strict';

const TEAMS=[
"FRANCE","SPAIN","GERMANY","ITALY","BRAZIL","ARGENTINA","ENGLAND","PORTUGAL",
"SENEGAL","BELGIUM","NETHERLANDS","USA","MEXICO","CANADA","JAPAN","S KOREA",
"AUSTRALIA","COSTA RICA","MOROCCO","EGYPT","IRAN","QATAR","URUGUAY","CHILE",
"SWITZERLAND","DENMARK","SWEDEN","POLAND","AUSTRIA","NORWAY","SCOTLAND","WALES"
];

const state={r32:Array(32).fill(null),r16:Array(16).fill(null),qf:Array(8).fill(null)};
const userSelections = { r32:[], r16:[], qf:[] };

function buildRound(container, teams, stage){
    container.innerHTML='';
    teams.forEach((t,i)=>{
        if(i%2!==0)return;
        const m=document.createElement('div');
        m.className='match';
        [0,1].forEach(offset=>{
            const idx=i+offset;
            const r=document.createElement('div');
            r.className='team-row';
            r.innerHTML=`<span class="team-name">${teams[idx]||'TBD'}</span>`;
            ['N','ET','P'].forEach(o=>{
                const b=document.createElement('button');
                b.textContent=o;
                b.dataset.o=o;
                b.onclick=()=>{
                    const base=Math.floor(idx/2)*2;
                    state[stage][base]=null;
                    state[stage][base+1]=null;
                    m.querySelectorAll('button').forEach(x=>x.classList.remove('selected'));
                    b.classList.add('selected');
                    state[stage][idx]=o;
                    userSelections[stage][Math.floor(idx/2)] = `${teams[idx]} (${o})`;
                    clearDownstream(stage);
                    propagate(stage);
                    refresh();
                };
                r.appendChild(b);
            });
            m.appendChild(r);
        });
        container.appendChild(m);
    });
}

function clearDownstream(stage){
    if(stage==='r32'){state.r16.fill(null);state.qf.fill(null); userSelections.r16=[]; userSelections.qf=[];}
    if(stage==='r16'){state.qf.fill(null); userSelections.qf=[];}
}

function propagate(stage){
    if(stage==='r32'){
        const adv=[];
        for(let i=0;i<32;i+=2){
            adv.push(state.r32[i]?TEAMS[i]:state.r32[i+1]?TEAMS[i+1]:null);
        }
        buildRound(document.getElementById('r16'),adv,'r16');
    }
    if(stage==='r16'){
        const names=[...document.getElementById('r16').querySelectorAll('.team-name')].map(n=>n.textContent);
        const adv=[];
        for(let i=0;i<16;i+=2){
            adv.push(state.r16[i]?names[i]:state.r16[i+1]?names[i+1]:null);
        }
        buildRound(document.getElementById('qf'),adv,'qf');
    }
}

function refresh(){
    const isComplete = 
        document.getElementById('user').value.trim() !== "" &&
        document.getElementById('email').value.trim() !== "" &&
        document.getElementById('goals').value !== "" &&
        state.r32.filter(x=>x!==null).length === 16 &&
        state.r16.filter(x=>x!==null).length === 8 &&
        state.qf.filter(x=>x!==null).length === 4;
    document.getElementById('lockBtn').disabled = !isComplete;
}

// --- PSBP LOGIC ---
let multiplier=1.00, psbpLocked=false;
const CARD_COUNT=40, BUST_COUNT=5;
let cardValues=[];
let bustIndexes=[];

function openPSBP() {
    document.getElementById('psbpOverlay').style.display = 'flex';
    initPSBP();
}

function initPSBP(){
    const grid = document.getElementById('cardGrid');
    grid.innerHTML = '';
    multiplier = 1.00;
    psbpLocked = false;
    document.getElementById('multiplierBox').textContent = "1.00";
    bustIndexes = [...Array(CARD_COUNT).keys()].sort(()=>Math.random()-0.5).slice(0,BUST_COUNT);
    
    for(let i=0; i<CARD_COUNT; i++){
        const card = document.createElement('div');
        card.className = 'card';
        const val = bustIndexes.includes(i) ? 0 : (Math.random() * 0.4 - 0.1).toFixed(2);
        cardValues[i] = parseFloat(val);
        card.innerHTML = `<span class="card-number" style="color:${val == 0 ? 'var(--warn)' : 'var(--ok)'}">${val == 0 ? '☠' : (val > 0 ? '+'+val : val)}</span>`;
        card.onclick = () => {
            if(psbpLocked || card.classList.contains('revealed')) return;
            card.classList.add('revealed');
            if(val == 0) {
                multiplier = 1.00;
                psbpLocked = true;
                setTimeout(() => { finishGame(); }, 800);
            } else {
                multiplier = Math.max(1, parseFloat((multiplier + cardValues[i]).toFixed(2)));
                document.getElementById('multiplierBox').textContent = multiplier.toFixed(2);
                if(multiplier > 2.0) {
                    multiplier = 1.00;
                    psbpLocked = true;
                    setTimeout(() => { finishGame(); }, 800);
                }
            }
        };
        grid.appendChild(card);
    }
}

function finishGame() {
    psbpLocked = true;
    document.getElementById('psbpOverlay').style.display = 'none';
    const summ = document.getElementById('finalSummary');
    const results = document.getElementById('summaryResults');
    
    let picksHtml = `
        <div class="summary-item"><strong>USER:</strong> ${document.getElementById('user').value}</div>
        <div class="summary-item"><strong>EMAIL:</strong> ${document.getElementById('email').value}</div>
        <div class="summary-item"><strong>GOAL TIEBREAKER:</strong> ${document.getElementById('goals').value}</div>
        <div class="summary-item"><strong>DUO:</strong> ${document.getElementById('duoSelect').value}</div>
        <div class="summary-item"><strong>FINAL MULTIPLIER:</strong> ${multiplier.toFixed(2)}</div>
        <hr style="margin:15px 0; border:1px solid var(--neon)">
        <h2 style="font-size:10px; color:var(--cyan)">BRACKET PICKS</h2>
    `;

    ['r32', 'r16', 'qf'].forEach(stage => {
        picksHtml += `<p style="color:var(--yellow); font-size:8px; margin-top:10px;">${stage.toUpperCase()}:</p>`;
        userSelections[stage].forEach((pick, i) => {
            if(pick) picksHtml += `<div class="summary-item">Match ${i+1}: ${pick}</div>`;
        });
    });

    results.innerHTML = picksHtml;
    summ.style.display = 'block';
}

buildRound(document.getElementById('r32'), TEAMS, 'r32');
</script>
</body>
</html>
